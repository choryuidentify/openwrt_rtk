From https://www.codeleading.com/article/87655954453/

diff '--color=auto' -urN mtd-utils-1.4.5/lib/libmtd.c mtd-utils-1.4.5-patched/lib/libmtd.c
--- mtd-utils-1.4.5/lib/libmtd.c	2011-06-25 15:10:49.000000000 +0900
+++ mtd-utils-1.4.5-patched/lib/libmtd.c	2021-12-02 01:45:01.102777989 +0900
@@ -33,6 +33,8 @@
 #include <sys/ioctl.h>
 #include <inttypes.h>
 
+#include <sys/sysmacros.h>
+
 #include <mtd/mtd-user.h>
 #include <libmtd.h>
 
diff '--color=auto' -urN mtd-utils-1.4.5/mkfs.jffs2.c mtd-utils-1.4.5-patched/mkfs.jffs2.c
--- mtd-utils-1.4.5/mkfs.jffs2.c	2011-06-25 15:10:49.000000000 +0900
+++ mtd-utils-1.4.5-patched/mkfs.jffs2.c	2021-12-02 01:45:11.630589204 +0900
@@ -74,6 +74,8 @@
 #include <crc32.h>
 #include <inttypes.h>
 
+#include <sys/sysmacros.h>
+
 #include "rbtree.h"
 #include "common.h"
 
diff '--color=auto' -urN mtd-utils-1.4.5/mkfs.ubifs/devtable.c mtd-utils-1.4.5-patched/mkfs.ubifs/devtable.c
--- mtd-utils-1.4.5/mkfs.ubifs/devtable.c	2011-06-25 15:10:49.000000000 +0900
+++ mtd-utils-1.4.5-patched/mkfs.ubifs/devtable.c	2021-12-02 01:45:32.522164380 +0900
@@ -48,6 +48,8 @@
 #include "hashtable/hashtable.h"
 #include "hashtable/hashtable_itr.h"
 
+#include <sys/sysmacros.h>
+
 /*
  * The hash table which contains paths to files/directories/device nodes
  * referred to in the device table. For example, if the device table refers
diff '--color=auto' -urN mtd-utils-1.4.5/mkfs.ubifs/mkfs.ubifs.h mtd-utils-1.4.5-patched/mkfs.ubifs/mkfs.ubifs.h
--- mtd-utils-1.4.5/mkfs.ubifs/mkfs.ubifs.h	2011-06-25 15:10:49.000000000 +0900
+++ mtd-utils-1.4.5-patched/mkfs.ubifs/mkfs.ubifs.h	2021-12-02 01:45:47.803715269 +0900
@@ -40,6 +40,7 @@
 #include <sys/types.h>
 #include <sys/stat.h>
 #include <sys/ioctl.h>
+#include <sys/sysmacros.h>
 #include <fcntl.h>
 #include <dirent.h>
 #include <errno.h>
--- mtd-utils-1.4.5/ubi-utils/src/libubi.c.orig	2021-12-02 01:59:09.031442509 +0900
+++ mtd-utils-1.4.5/ubi-utils/src/libubi.c	2021-12-02 02:00:11.951209775 +0900
@@ -32,6 +32,7 @@
 #include <sys/ioctl.h>
 #include <sys/stat.h>
 #include <sys/types.h>
+#include <sys/sysmacros.h>
 #ifdef __CYGWIN__
 #include <cygwin/ioctl.h>
 #endif
